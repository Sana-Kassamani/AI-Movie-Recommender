<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stopwatch Example</title>
</head>
<body>
    <!-- Table Element -->
    <table id="myTable">
        <tr><td>Row 1</td></tr>
        <tr><td>Row 2</td></tr>
    </table>

    <!-- Stop Button -->
    <button id="stopButton">Stop Stopwatch</button>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.7/axios.min.js" integrity="sha512-DdX/YwF5e41Ok+AI81HI8f5/5UsoxCVT9GKYZRIzpLxb8Twz4ZwPPX+jQMwMhNQ9b5+zDEefc+dcvQoPWGNZ3g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>
        let startTime;  // Store the start time
        let elapsedTime = 0; // Store elapsed time when stopped
        let isRunning = false; // State of the stopwatch
        let time_spent_cst=0;
        // Start the stopwatch when the table is loaded
        const table = document.getElementById("myTable");
        window.addEventListener("load", () => {
            if (table) {
                startStopwatch();
            }
        });

        // Function to start the stopwatch
        function startStopwatch() {
            if (!isRunning) {
                startTime = new Date().getTime(); // Record the current time
                isRunning = true; // Set running state to true
                console.log("Stopwatch started.");
            }
        }

        // Function to stop the stopwatch and log the final time
        function stopStopwatch() {
            if (isRunning) {
                const now = new Date().getTime();
                elapsedTime = now - startTime; // Calculate elapsed time
                isRunning = false; // Set running state to false

                const data = new FormData();
                data.append("user_id", 1);
                data.append("movie_id", 1);

                axios("http://localhost/movie_recommenderdb/AI-Movie-Recommender/server-side/getActivity.php",{
                    method: "POST",
                    data:data,
                    
                }).then((response) => {
                    time_spent_cst = response.data.response.time_spent
                    console.log(response.data.response.time_spent)
                }).catch((error)=>{
                    console.log("error getting insidghts")
                })
                elapsedTime = time_spent_cst+elapsedTime
                console.log(`Stopwatch stopped. Total time: ${elapsedTime} ms`);
            }
        }

        // Add event listener to the button
        const stopButton = document.getElementById("stopButton");
        stopButton.addEventListener("click", stopStopwatch);
    </script>
</body>
</html>
